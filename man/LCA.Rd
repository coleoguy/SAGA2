% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/LCA.R
\name{LCA}
\alias{LCA}
\title{Model Averaged Line Cross Analysis}
\usage{
LCA(
  data,
  SCS = "XY",
  parental = "calc",
  env = FALSE,
  model.sum = 0.95,
  max.models = 3e+05,
  drop.pars = NULL,
  keep.pars = NULL,
  max.pars = NULL,
  Cmatrix = NULL,
  ret.all = FALSE,
  messages = TRUE,
  Mepi = FALSE
)
}
\arguments{
\item{data}{A data frame with 7 columns:
\describe{
\item{cross}{Character. Name of each cohort (e.g., "P1", "P2", "F1",
"rF1", "BC1a"). P1 and P2 must be present for the two parental
strains.}
\item{mean}{Numeric. Mean phenotype measure of the cohort.}
\item{SE}{Numeric. Standard error of the cohort mean.}
\item{sex}{Character. Sex of the cohort: \code{"M"} (male), \code{"F"} (female),
\code{"E"} (equal ratio), or \code{"U"} (unknown/unequal).}
\item{enviro}{Numeric. Environmental variable for each cohort. Can be
\code{NA} if not applicable.}
\item{sire}{Integer. Row number of the sire in the data frame.}
\item{dam}{Integer. Row number of the dam in the data frame.}
}}

\item{SCS}{Character. Sex chromosome system: \code{"XY"}, \code{"XO"}, \code{"ZW"},
\code{"ZO"}, or \code{"NSC"} (no sex chromosomes). Default is \code{"XY"}.}

\item{parental}{Character. Method for calculating parental effects:
\code{"calc"} uses traditional calculated genetic maternal effects;
\code{"obs"} uses observed phenotypic parental effects rescaled to [-1, 1].
Default is \code{"calc"}.}

\item{env}{Logical. Whether to include environmental and gene-by-environment
interactions. Default is \code{FALSE}.}

\item{model.sum}{Numeric between 0 and 1. Cumulative probability threshold
for the confidence set of models. Default is \code{0.95}.}

\item{max.models}{Integer. Maximum number of fitted model objects to store
and return. Only affects memory usage; all models are still evaluated
internally. Default is \code{300000}.}

\item{drop.pars}{Character vector. Names of CGEs to exclude from the
analysis (e.g., \code{c("Ca", "Mea")}). Default is \code{NULL}.}

\item{keep.pars}{Character vector. Names of CGEs to include in the analysis.
If specified, only these CGEs (plus the mean) will be tested. Default is
\code{NULL}.}

\item{max.pars}{Integer. Maximum number of parameters allowed in any single
model equation. Useful for reducing computation time with large model
spaces. Default is \code{NULL} (determined automatically).}

\item{Cmatrix}{Optional matrix. A user-supplied C-matrix describing the
expected contribution of CGEs to each cohort. If \code{NULL}, the C-matrix
is constructed automatically from the breeding design. Default is \code{NULL}.}

\item{ret.all}{Logical. Whether to return fitted model objects for all
evaluated models. Setting to \code{TRUE} increases memory usage substantially.
Default is \code{FALSE}.}

\item{messages}{Logical. Whether to print progress messages during the
analysis. Default is \code{TRUE}.}

\item{Mepi}{Logical. Whether to include interactions between maternal
effects and standard genetic effects. Experimental. Default is \code{FALSE}.}
}
\value{
A \code{"genarch"} object (a list) with the following elements:
\describe{
\item{all.models}{A list of fitted \code{glm} model objects for all evaluated
models (or \code{NULL} if \code{ret.all = FALSE}).}
\item{best.models}{A list of fitted \code{glm} model objects for models in
the confidence set.}
\item{best.eqns.w}{Numeric vector of Akaike weights for models in the
confidence set.}
\item{estimates}{A 2-row matrix with model-weighted average parameter
estimates (row 1) and unconditional standard errors (row 2) for each
CGE.}
\item{daicc}{Numeric vector of delta AICc scores for all evaluated
models.}
\item{varimp}{A 2-column matrix with CGE names (column 1) and variable
importance scores (column 2).}
\item{cmatrix}{The C-matrix used in the analysis, with cross names
prepended.}
}
}
\description{
Analyze all possible genetic architecture models based on mean phenotypes
from line cross data. Uses an information-theoretic approach with AICc-based
model selection to produce model averaged estimates of composite genetic
effects (CGEs) and unconditional standard errors.
}
\details{
The analysis proceeds by:
\enumerate{
\item Constructing a C-matrix of expected CGE contributions (or using a
user-supplied one).
\item Fitting all possible weighted least squares models.
\item Calculating AICc and Akaike weights for each model.
\item Constructing a confidence set of models.
\item Computing model-averaged parameter estimates and unconditional
standard errors following Burnham and Anderson (2002).
}

When \code{parental = "obs"}, cohort phenotypes are rescaled to [-1, 1] and
used as the expected contribution of maternal or paternal effects, which
can better capture parental effects not mediated through autosomal additive
or dominance mechanisms.
}
\examples{
data(BanInf)
result <- LCA(BanInf, SCS = "NSC", messages = FALSE)
result$estimates
plot(result)
}
\references{
Blackmon, H. and Demuth, J.P. (2016). An information-theoretic approach to
estimating the composite genetic effects contributing to variation among
generation means: Moving beyond the joint-scaling test for line cross
analysis. \emph{Evolution}, 70(2), 420--432.

Burnham, K.P. and Anderson, D.R. (2002). \emph{Model selection and multimodel
inference: a practical information-theoretic approach}. Springer.
}
\seealso{
\code{\link[=plot.genarch]{plot.genarch()}} for plotting results, \code{\link[=VisModelSpace]{VisModelSpace()}} for
visualizing model space, \code{\link[=EvaluateModel]{EvaluateModel()}} for single model evaluation,
\code{\link[=plotObserved]{plotObserved()}} for traditional LCA plots.
}
